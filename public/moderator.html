<!doctype html>
}
function renderSongs(total, active, currentTitle){
// Zeige Nâ†’1, active ist 0..N-1 (Server-Index)
songList.innerHTML = '';
for (let i = total; i >= 1; i--) {
const idxFromTop = i - 1; // 0..N-1 von oben (Song N zuerst)
const div = document.createElement('div');
div.className = 'song' + (idxFromTop===active ? ' active' : '');
const left = document.createElement('div');
left.textContent = `Song ${i}`;
const right = document.createElement('div');
right.className = 'badge';
if (idxFromTop===active && currentTitle) right.textContent = currentTitle;
div.appendChild(left); div.appendChild(right);
songList.appendChild(div);
}
}


// Socket Events
socket.on('mod:room-created', ({ code, progress, playlists }) => {
el('#roomCode').textContent = code;
el('#roundName').textContent = progress.roundName;
renderRounds(playlists, progress.roundIndex - 1);
renderSongs(progress.songTotal, progress.songIndex - 1, '');
});


socket.on('ui:round-update', ({ progress, playlists, activeRound, activeSong, currentTitle }) => {
el('#roundName').textContent = progress.roundName;
renderRounds(playlists, activeRound);
renderSongs(progress.songTotal, activeSong, currentTitle||'');
});


socket.on('round:prepare', ({ src, title }) => {
audio.src = src || '';
el('#currentTitle').textContent = title || 'â€“';
});
socket.on('audio:play', () => audio.play().catch(()=>{}));
socket.on('audio:pause', () => audio.pause());


socket.on('buzz:first', ({ name }) => {
el('#status').textContent = `ðŸ”” ${name} hat zuerst gebuzzert!`;
});


socket.on('scores:update', (scores) => {
const players = window._players || [];
const list = el('#players');
list.innerHTML = '';
players.forEach(p => {
const div = document.createElement('div');
div.className = 'player';
div.innerHTML = `<span>${p.name}</span><strong>${scores[p.id]||0}</strong>`;
list.appendChild(div);
});
});


socket.on('room:update', ({ players }) => {
window._players = players;
const list = el('#players');
list.innerHTML = '';
players.forEach(p => {
const div = document.createElement('div'); div.className='player';
div.innerHTML = `<span>${p.name}</span><strong>0</strong>`;
list.appendChild(div);
});
});


socket.on('progress:update', (p) => {
el('#roundName').textContent = p.roundName;
});


socket.on('status', (t) => el('#status').textContent = t);
</script>
</body>
</html>